CREATE TABLE USERS(
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USERNAME VARCHAR2(50) UNIQUE NOT NULL,
    PASSWORD VARCHAR2(255) NOT NULL,
    ROLE VARCHAR2(50) NOT NULL
);

CREATE TABLE UPLOADS (
    UPLOAD_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    EXCEL_NAME VARCHAR2(200),
    DEPARTMENT VARCHAR2(50),
    YEAR VARCHAR2(10),
    SECTION VARCHAR2(10),
    FROM_DATE DATE,
    TO_DATE DATE,
    ACADEMIC_YEAR VARCHAR2(20),
    UPLOADED_BY VARCHAR2(100),
    UPLOAD_TIME TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE STUDENTS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ROLL_NO VARCHAR2(20) UNIQUE,
    NAME VARCHAR2(100),
    PHONE_NUMBER VARCHAR2(20),
    DEPARTMENT VARCHAR2(50),
    YEAR VARCHAR2(10),
    SECTION VARCHAR2(10),
    ACADEMIC_YEAR VARCHAR2(10),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE SMS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    STUDENT_ID NUMBER REFERENCES STUDENTS(ID),
    UPLOAD_ID NUMBER REFERENCES UPLOADS(UPLOAD_ID),
    MESSAGE CLOB,
    ATTENDANCE NUMBER,
    STATUS VARCHAR2(20) DEFAULT 'pending',
    SMS_SENT NUMBER(1) DEFAULT 0,
    SEEN NUMBER(1) DEFAULT 0,
    ERROR_MESSAGE VARCHAR2(255),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE ACKNOWLEDGEMENT (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    SMS_ID NUMBER REFERENCES SMS(ID),
    STUDENT_ID NUMBER REFERENCES STUDENTS(ID),
    ACK_LINK VARCHAR2(255),
    ACK_STATUS VARCHAR2(20) DEFAULT 'not_acknowledged',
    ACK_TIME TIMESTAMP,
    REMARKS VARCHAR2(255)
);

CREATE TABLE TEMPLATES (
    ID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    TEMPLATE_NAME VARCHAR2(100) NOT NULL,
    TEMPLATE_TEXT CLOB NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE EDITED_TEMPLATES (
    ID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    ORIGINAL_TEMPLATE_ID NUMBER REFERENCES TEMPLATES(ID),
    TEMPLATE_NAME VARCHAR2(100) NOT NULL,
    TEMPLATE_TEXT CLOB NOT NULL,
    CREATED_BY VARCHAR2(50),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

